# Project2开发文档

###### 17300290033高祥兴

Github地址：https://github.com/CharlesGao04/Web_PJ2

### 项目完成情况

#### 1.首页

登录逻辑完成，未登录时右上角显示Login，登录后显示My Account的下拉菜单，最后一个菜单条目为Log out

刷新逻辑完成，刷新按钮会将页面，通过数据库random读取6张图片并展示

图片逻辑完成，开始通过sql从数据库中的travelimagefavor表中找出收藏人数最多的6张图片

###### 备注：主页index一开始写成了php文件，后发现需求文档中的要求就另添加一个index.html，通过js写window.location.href=‘index.php’直接跳转到index.php文件，效果一样

#### 2.浏览页

筛选逻辑，三种筛选：1、标题筛选，通过sql语句的like实现，可以进行单字段模糊查询；2、多级筛选，实现了国家与城市的二级联动，其中国家通过php读取数据库生成json文件，再通过js读json文件动态生成国家选项列表，而城市json数据太大，有12万多条，于是当国家onchange后通过jQuery的ajax实现从php读取国家对应的城市列表并放置选项列表中，其中由于部分国家城市数量太多，设置了只取人口前20的城市；3、热门筛选，热门有三种，皆可点击，通过选择前几个条目实现，其实我对于热门的理解认为可以是通过各条目进行groupby，每个条目对应图片的数量降序排序，选取前几个即可

图片逻辑，点击图片可以跳转到图片详情页面，同时页码功能全部实现，包括点击、向前向后、只截取前5页，当前页面高亮

#### 3.搜索页

搜索逻辑，跟浏览页筛选类似，只不过多了一个Description类型可以选择搜索

图片逻辑，结果展示也跟浏览页类似，点击可跳转至对应的图片详情页面

#### 4.登录页面

登录逻辑，通过与数据库的用户名、密码作对比，错误的用户名或密码会报错并提示，登录成功后跳转到主页

#### 5.注册页面

注册逻辑，用户可通过用户名、邮箱、密码、确认密码进行注册，密码未显示明文，其中两次密码需要相同，也进行了合法性检验，将用户名、邮箱和密码格式要求均注明在界面上，若是出现类似非法用户名、输入密码不一致等情况会有明文提示，并且无法注册

#### 6.我的照片

图片逻辑，没有图片时有文字提示，并且可以点击upload文字跳转至upload界面增加图片，有图片时可以点击修改按钮跳转，点击图片可跳转至对应图片详情页面

删除逻辑，删除按钮可正常使用，会同时将数据库中对应图片内容删除，也就是travelimage表中的数据删除

#### 7.我的收藏

展示逻辑，没有收藏时有文字提示，通过travelimagefavor表中的数据显示收藏的照片

删除逻辑，点击删除按钮会将图片从travelimagefavor表中删去，但并不会将其从travelimage表中删去

#### 8.上传页面

合法性校验，有合法性检验，信息不完整无法删除，并且会提示补全信息，upload是数据库通过insert实现

修改逻辑，若是通过修改按钮进入界面，按钮会改为Modify字样，会自动填充原有内容，修改图像数据库是通过update实现

功能修改：三个下拉菜单均实现，其中国家与城市依旧实现二级联动

#### 9.详细图片页面

信息展示，可以正确显示图片、标题、国家、城市、描述、收藏人数等内容

收藏功能，一开始按钮显示no collect字样，点击后，收藏人数+1，按钮字样变为already collected，再次点击，收藏人数-1，按钮切换回no collect

### Bonus

#### 1.密码加盐

通过md5实现简单的密码加盐，数据库存储的是加盐后的数据，其中raw_output选的是自己的姓名缩写，当然md5比较容易被破解，也曾想过用SHA-3或者Node.js的bcryptjs进行哈希加盐，但这不是本次lab的重点就没有过多深入

#### 2.前端工具

本次PJ是在PJ1代码基础上进行改动的，并未使用框架，但是使用了CSS的Bootstrap库和JS里的jQuery库，也通过npm管理配置过一些依赖

#### 3.部署服务器

在阿里云上租借了一台服务器，并将整个PJ2部署在上面，sql文件也导入至服务器上的phpmyadmin内，Apache以及php版本均与本地一致，可以通过39.97.168.18:81正常访问

### 对PJ2和本门课程的建议

PJ2整体内容和逻辑都很完整，极大锻炼了个人写php的能力，不过对于详细图片页面的要求感觉可以更完整，当收藏按钮切换时，其实收藏人数也需要改变，甚至数据库中图片的收藏人数也可以改变，实现起来也不复杂，但感觉这样逻辑更严谨hh

